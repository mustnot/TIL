## IAM (Identity and Access Management)

> AWS Identity and Access Management(IAM)는 AWS 리소스에 대한 액세스를 안전하게 제어할 수 있는 웹 서비스로, IAM을 사용하여 리소스를 사용하도록 인증(로그인) 및 권한 부여(권한 있음)된 대상을 제어합니다. - AWS IAM 사용 설명서

누구나 접속 가능한 온라인 서비스에서는 접근 관리가 무엇보다 중요한데, AWS에서는 IAM을 이용하여 사용자의 권한을 제어할 수 있다. 이 때의 사용자는 클라이언트를 말하는 것이 아닌 서버를 관리하는 엔지니어가 주된 사용자로 보면 좋을 것 같다. (클라이언트가 직접 서버를 제어하는 경우는 없으니 ?) 접근 관리의 중요성은 말로 몇 번을 말해도 부족할 정도로 중요하다는 것만 알고 있으면 된다. (원래 경험해보기 전까지는 중요하다고 해도 중요한지 모르는 경우가 허다하다. (나 포함))

나는 IAM을 이해하면서 카드키를 많이 연상했다. 카드키도 어떻게 살펴보면 각 방마다 설정된 보안 설정으로 인해 접근할 수 있는 사람이 구분되어 있는 것이 IAM과 비슷하다고 생각되었다. 좀 더 단순하게 생각하면 각 기능들이 방이라고 생각하면 그 방에 접근할 수 있는 권한을 가지는 사람을 구분하고 그에 맞는 카드키를 전달해주는 것이 중요하기 때문이다. (모든 사람에게 모든 방에 접근할 수 있는 권한을 주었다고 생각해보자.. 내가 회장실에 들어갈 수 있다면..? ㅎㅎ)

> 내가 IAM을 조금이라도 알아보려고 하는 이유는 전날 Zappa를 이용해서 Lambda에 Flask App을 배포하는 공부를 하다보니, AWS IAM을 이용해서 유저를 생성하고, 생성된 유저를 이용해 `awscli`을 구성하는걸 보고 그럼 IAM을 조금이라도 공부해야겠구나 생각해서 공부하게 되었다. 

![F8DA4730-4D2C-4781-8BBC-4210B64CAAB1](https://user-images.githubusercontent.com/52126612/85944612-0c7b3480-b973-11ea-8967-450794238136.jpg)


위 이미지는 AWS 로그인 시 선택하는 사용자 선택란이다. 루트 사용자와 IAM 사용자를 구분하여 접속이 가능하도록 설계되어 있다. 그럼 AWS에서 IAM 사용자는 어떻게 생성되고 어떤 과정을 거치는지 간단하게 알아보자. AWS의 IAM(Identity and Access Management)를 서비스에서 찾아 들어가면, 좌측 사이드바에 대시보드, 액세스 관리, 보고서 엑세스 등이 있는데, 여기서 엑세스 관리를 살펴보면, 그룹, 사용자, 역할, 정책, 자격 증명 공급자, 계정 설정 6개로 구성되어 있다. 간단하게 살펴보는게 목적이니 만큼 나는 여기서 그룹(Group), 사용자(User), 역할(Role), 정책(Policy)에만 집중해서 보았다. (다른 것까지...)

![9DFAA173-7582-4C33-9C23-489EFB66C382](https://user-images.githubusercontent.com/52126612/85944609-0b4a0780-b973-11ea-8acd-ee7097a448a9.jpg)



각 기능들의 역할을 생각해보자! 우선 그룹(Group)부터 생각해보면 각 사용자(User)에게 권한(Role)을 일일이 설정해주기는 생각보다 까다롭고 번거롭다. (사실 번거로운 이유가 가장 큰 이유 같다.) 무엇보다 가장 번거로운건 대기업(?) 아무튼 큰 개발 집단일 수록 관리 인력이 굉장히 많을텐데, 이 많은 인원들에게 개인마다 권한을 부여하고 관리하기는 정말로 까다로운 일이다. 그래서 그룹이라는 기능이 생긴게 아닌가 싶다. 사실 Windows와 Linux를 조금이라도 사용해본 사용자라면, 그룹이 무엇인지 대조해서 이해하기가 쉽다고 생각되는데, Windows에서는 Administrator 계정이 있고, (대개 첫 생성되는 유저 계정이 Administrator와 동일한 권한을 가진다.) 생성되는 유저마다 특정 디스크 혹은 폴더에 읽기/쓰기 권한이 분리되어 있어 프로그램을 설치하거나 삭제하는 요청들이 제한되는데 이것과 동일하다고 보면 되고, Linux에서는 Ubuntu를 예시를 들면 (다른 OS도 동일하겠지만 Ubuntu만 써본 나로선..) sudo 계정을 가진 root 계정과 그에 각 그룹에 생성된 user들이 있어, 각 user마다 실행할 수 있는 권한이 다른 것과 유사하다. 실제로 ubuntu 폴더를 보면 사용자와 그룹이 나누어져있다.

각 기능마다 설정할 수 있는 것들이 무엇이 있나 보자.

### 그룹 (Group)

그룹을 선택해서 들어가면 먼저 그룹 리스트를 볼 수 있는데 (나는 아직 아무것도 한게 없으니 이미지를 예시로 못 들겠다.) 아무튼 그 위에는 **새로운 그룹 생성**과 **그룹 작업**이 있다. 여기서 새로운 그룹 생성을 선택하여 눌러보면, 매우 심플하게 3단계로 되어 있고, 각 단계는 그룹 이름, 정책 연결, 검토가 있다. (검토 빼면 사실 2단계만 있는 것 같지만 검토도 중요하니.)

그룹 이름을 간단하게 정하고 다음 단계인 정책 연결 단계로 오면 정말로 엄청난 정책들이 **영어로!** 나열되어 있다. 하나씩 설명할 수가 없다. 가장 최상단에 있는 정책만 살펴보면, **AdministratorAccess**로 관리자 접근으로 root 계정과 거의 동일한 권한을 갖는 정책이 아닐까 생각된다. 



### 사용자 (User)

사용자는 어제 생성해봐서 생략하고 싶지만 이것도 그룹과 마찬가지로 정말로 단순하다. **사용자 추가**를 들어가서 이름을 설정한 후에 액세스 유형을 선택하면 되는데, 유형은 두 가지로 **프로그래밍 방식 액세스**와 **AWS Management Console 액세스** 두 가지로 구분되어 있다. (말그대로 기능을 제공하는 것 같다.) 선택한 후에 다음으로 넘어가면 **권한 설정**이 진행된다.

권한 설정에서는 **그룹에 사용자 추가**, **기존 사용자에서 권한 복사**, **기존 정책 직접 연결** 세 가지 중 하나를 선택하여 과정을 진행할 수 있고, 이 때 느낀 점은 정말로 AWS는 사용자 편의를 위한 구조가 잘 짜여있구나!라고 생각했다. (나만 그런가?) 아무튼 세 가지 중 하나를 선택하여 진행하면 가장 마지막에는 액세스 방식에 따른 키를 제공한다. 



### 역할 (Role)

AWS에서는 IAM 역할이란? 신뢰하는 개체에 권한을 부여하는 안전한 방법입니다. 여기서 개체란 IAM 사용자, 실행중인 애플리케이션 코드, AWS 서비스, 디렉토리의 사용자이다. 이 때 IAM 역할은 권한을 부여하는 더욱 안전한 방법으로 짧은 기간 동안 유효한 키를 발행합니다. 라고 설명하고 있다. 역할 생성을 선택하면 아래와 같이 개체를 선택할 수 있는 항목들을 보여주고, 아래에 서비스 선택하고 그에 맞는 권한 정책들을 연결해준다. (영어 싫어..)

![5C4EC323-6701-4252-89D3-4DA4E5A200DF](https://user-images.githubusercontent.com/52126612/85944608-0ab17100-b973-11ea-8944-31e0c6e96d8e.jpg)



### 정책 (Policy)

정책은 정말로 많아서 하나씩 해보는게 가장 좋기도 하겠지만 무엇보다 영어만 잘한다면 바로 이해할 수 있을 것 같다. 아래 이미지는 내 계정으로 들어간 정책 리스트인데, 아무것도 생성하지 않은 상태임에도 불구하고 가장 기본적인 정책이 685개이다. (어마무시하다) 간단하게 살펴보면, AlexaForBusiness 부터 보면, FullAccess부터 DeviceSetup, GateWayExecution 등으로 작게 구분되어 있는 걸 볼 수 있는데 예상컨데, FullAccess > DeviceSetup = GateWayExecution 으로 권한이 작게 분리된 것 같다. (실제로 Alexa를 써본 적이 없어서 설명할 수가 없는데 나중에 써본다면 추가로 작성해봐야겠다.)

![4A4AB356-9DCF-4E6D-8C7D-1271A2ED4E86](https://user-images.githubusercontent.com/52126612/85944606-06855380-b973-11ea-9951-2baaa307d8f7.jpg)




## 마무리

아주아주 x100 간단하게 살펴보았는데 IAM이라는 단어를 계속 읽다보니 IAM이라는 약자 굉장히 잘 지은 것 같다고 생각되었다. 지금까지 AWS 기능 내 몇가지 서비스들에 대한 약자를 생각해보았을 때 IAM처럼 직관적인 이름은 없는 것 같다. (AWS에서 지은 이름은 아니지만) 왜 그렇게 생각했냐면 마치 누군가 초인종을 누르고 I'm ~ 라고 내가 누구인지 소개하는 것 같다. 그 소개를 듣고 문을 열어줄지 아니면 계속 닫고 있을지는 듣는 사람이 결정하는 것처럼 말이다. 

내가 그 동안 서버를 몇 개 받고 그 안에 `python`이라던지 `nginx` `uWSGI` `docker` 등을 구성해보면서 사실 권한이라는 걸 크게 생각해본 적이 없었다. 가장 큰 이유로는 클라이언트의 접근만 신경쓴다던지, IP 접근을 막는 방화벽만 신경 썼는데 이번을 통해서 내 자신을 반성하게 되었고 회사에서 AWS 내에 서버를 구성할 일이 있다면 사용자(User)를 구분한다던지 각 권한을 잘 구성하여 그룹(Group)을 만들어본다던지 해보면 재밌을 것 같다. (진짜?)

