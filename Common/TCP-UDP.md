# TCP/UDP

> TCP / UDP 를 자주 사용하는데 정확히 어떤 차이가 있는지 알아야 할 것 같아 공부했다.

<br>

### UDP (User Datagram Protocol)

UDP(User Datagram Protocol)란, 사용자 데이터그램 프로토콜로 **비연결성 프로토콜** 이다. IP 데이터 그램을 캡슐화하여 보내는 방법과 연결 설정을 하지 않고 보내는 방법을 제공한다. `UDP` 는 흐름제어, 오류제어 또는 손상된 세그먼트의 수신에 대한 재전송을 하지 않는다. 이 모두가 사용자 프로세스의 몫으로, UDP가 행하는 것은 포트를 사용하여 IP 프로토콜에 인터페이스를 제공한다.

종종 클라이언트는 서버로 짧은 요청을 보내거나, 짧은 응답을 원한다. 만약 이 때 요청 또는 응답이 손실된다면, 클라이언트는 time out으로 다시 시도할 수 있으면 된다. 코드가 간단할 뿐만 아니라 TCP 처럼 초기 설정 (initial setup) 에서 요구되는 프로토콜보다 적은 메시지가 요구된다.

`UDP` 를 사용하는 것 중 대표적인 것으로 `DNS`가 있는데, 어떤 호스트 네임의 IP 주소를 찾을 필요가 있는 프로그램은, DNS 서버로 호스트 네임을 포함한 UDP 패킷을 보낸다. 이 서버는 호스트의 IP 주소를 포함한 UDP 패킷으로 응답하는데, 사전에 어떠한 설정도 필요하지 않으며 그 후에 해제가 필요하지 않다.

**UDP**가 특별히 유용한 분야는 클라이언트-서버 상황인데, 그러다보니 대표적으로 DNS가 있는 것이다. DNS 서버는 주로 클라이언트의 짧은 요청에 짧은 응답으로 빠른 인터넷 연결을 지원한다.



### TCP (Transmission Control Protocol)

TCP(Transmission Control Protocol)란, 전송 제어 프로토콜로 UDP와 달리 "제어"라는 단어가 들어간 프로토콜이다. 대부분의 인터넷 응용 분야에서는 **신뢰성**과 **순차적인 전달**을 필요로 하는데, 단순히 보내고 받기만 하는 UDP는 이를 만족할 수 없다. 그래서 탄생한 것이 TCP이다. TCP는 신뢰성이 없는 인터넷을 통해 종단간에 신뢰성 있는 바이트 스트림을 전송하도록 특별히 설계되어, TCP 서비스는 송신사와 수신자 모두가 소켓이라고 부르는 종단점을 생성함으로써 이루어진다. TCP에서 연결 설정 (Connection Establishment)는 `3-way handshake` 를 통해 행해진다.

모든 TCP 연결은 전이중(full-duplex), 점대점(point-to-point) 방식으로 연결된다.

* 전이중 : 전송이 양방향으로 동시에 일어날 수 있음을 의미하며, 데이터를 요청하기만 하는 것이 아니라 양방향 간 커뮤니케이션이 가능하다.
* 점대점 : 각 연결이 정확히 2개의 종단점을 가지고 있음을 말한다.

TCP는 멀티캐스팅이나 브로드캐스팅을 지원하지 않는다.



#### TCP 3 way handshake

TCP는 정확한 전송을 보장해야한다. 앞서 설명한 것처럼, TCP가 신뢰성의 필요로 인해 탄생한 것이기 때문에 논리적인 접속을 성립하기 위해 `3 way handshake` 과정을 진행한다.

1. 클라이언트가 서버에게 SYN 패킷을 보냄 (sequence: x)
2. 서버가 SYN(x)를 받고, 클라이언트에게 받았다는 신호인 ACK와 SYN 패킷을 보냄 (sequence: y, ACK:  x+1)
3. 클라이언트는 서버의 응답을 ACK(x+1)와 SYN(y) 패킷을 받고, ACK(y+1)을 서버로 보냄

이렇게 3번의 통신이 모두 완료되면 연결이 성립된다.

