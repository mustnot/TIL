# HTTPS

HTTPS (Hyper Text Transfer Protocol over Secure Socker Layer, HTTP over TLS, HTTP over SSL, HTTP Secure)는 웹 통신 프로콜인 HTTP의 보안이 강화된 버전으로 HTTPS는 통신의 인증과 암호화를 위해 개발되어 전자 상거래에서 널리 쓰인다.

HTTPS는 소켓 통신에서 일반 텍스트를 이용하는 대신에 SSL이나 TLS 프로토콜을 통해 세션 데이터를 암호화하여 데이터의 적절한 보호를 보장한다. 보호의 수준은 웹 브라우저에서의 구현 정확도와 서버 소프트웨어, 지원하는 암호화 알고리즘에 달려있다.

HTTP의 경우 클라이언트가 요청한 페이지를 암호화 되지 않은 상태로 주고 받을 수 있어 HTTP로 만든 홈페이지는 클라이언트와 서버의 네트워크에 침입해 중간에서 정보를 가로챌 수 있는 위험이 상존하는데, HTTPS의 경우 보안성이 매우 강해, 보안이 필요한 은행, 쇼핑몰, 정부사이트 등에서 HTTPS로 된 홈페이지를 사용한다. HTTPS의 암호화는 "클라이언트는 공개키를", "서버는 서버만 알 수 있는 개인키를" 이용하는 방식으로, 클라이언트가 사이트에 접속하게 되면 공개키를 이용자에게 보내 이를 통해 이용자의 암호화된 정보를 서버에 저장된 개인키로 볼 수 있다.



#### HTTPS에서 제공하는 특징

1. **기밀성** : HTTPS는 인터넷과 같은 공공 매체에서 두 참여자 간의 통신을 보호한다. 예를 들어 HTTPS가 없다면 와이파이 액세스 포티은트를 운영하는 사람은 액세스 포인트를 사용하는 사람이 온라인에서 무언가를 구입했는지, 신용카드와 같은 개인정보 등을 볼 수 있다.
2. **무결성** : HTTPS는 변조되지 않은 정보로 목적지에 도달하는데, 예를 들어 와이파이가 웹사이트에 광고를 추가하거나 대역폭을 절약하고자 이미지 품질을 저하시키거나, 읽는 기사의 내용을 변조할 수 있지만, HTTPS는 웹사이트를 변조할 수 없도록 한다.
3. **인증** : HTTPS를 통해 웹사이트의 진위 여부를 확인할 수 있는데, 예를 들어, 와이파이 액세스 포인트를 운영하는 사람이 가짜 웹 사이트를 브라우저에 보낼 수 있다. (DNS 서버 도용)



<br>

## SSL 인증서

SSL (Secure Socker Layer) 인증서란, SSL를 의미하는 것으로 주고 받은 정보가 암호화되어 있음을 뜻한다. 즉 웹서버와 웹사이트에서 이루어지는 모든 정보 및 데이터의 전송이 https://로 암호화프로토콜을 통해 안정하게 전송되게 하는 인증서이다.



### SSL 인증서의 장점 및 역할

통신 내용이 노출, 변경되는 것을 방지하고, 클라이언트가 접속하려는 서버가 신뢰할 수 있는 서버인지 확인 가능, SSL 통신에 사용할 공개키를 클라이언트에게 제공한다. 인증서의 내용은 CA의 비공개 키를 이용해서 암호화되어 웹 브라우저에게 제공된다. 주로 서비스 정보 (인증서 발급자, CA의 디지털 서명, 서비스 도메인), 서버측 공개키 등



### SSL 인증서의 서비스 보증 방법

* 웹브라우저가 서버에 접속하면 서버는 제일 먼저 인증서를 제공한다.
* 브라우저는 인증서를 발급한 CA가 가지고 있는 CA 리스트에 있는지 확인한다.
* 리스트에 있다면 해당 CA의 공개키를 이용하여 인증서를 복호화한다.
* 인증서를 복호화 할 수 있다는 것은 이 인증서가 CA의 비공개키에 의해서 암호화된 것을 의미한다. 즉 데이터를 제공한 사람의 신원을 보장하게 된다.



### SSL 동작 방법

공개키 암호 방식은 알고리즘 계산방식이 느린 경향이 있어, SSL은 암호화된 데이터를 전송하기 위해 공개키와 대칭키 암호화 방식을 혼합하여 사용한다.

안전한 의사소통 채널을 수립할 때는 공개키 암호를 사용하고 이렇게 만들어진 채널을 통해 임시의 무작위 대칭키를 생성 및 교환한다. 해당 대칭키는 나머지 데이터 암호화에 활용한다.

* 실제 데이터 암호화 방식 : 대칭키
* 상기 대칭키를 서로 공유하기 위한 암호화 방식 : 공개키



### SSL 통신 과정

컴퓨터와 컴퓨터가 네트워크를 통해 통신 할 때에는`핸드쉐이크 -> 세션 -> 세션 종료` 과정을 거치는데, 암호화된 HTTP 메시지를 교환하기 전에 클라이언트와 서버는 SSL 핸드쉐이크를 진행한다.

핸드 쉐이크의 목적

* 프로토콜 버전 교환
* 양쪽이 알고 있는 pre master secret 키 생성 및 교환
* 양쪽의 신원 인증
* 채널을 암호화 하기 위한 임시 세션 키 생성



### SSL에서 사용하는 암호화 종류

* 암호 : 텍스트를 아무나 읽지 못하도록 인코딩하는 알고리즘
* 키 : 암호의 동작을 변경하는 매개변수, 키에 따라 암호화 결과가 달라지기 때문에 키를 모르면 복호화가 불가능하다.



#### 대칭키 암호화 방식

* 인코딩과 디코딩에 같은 키를 사용하는 알고리즘
* 단점 : 발송자와 수신자가 서로 대화하려면 둘 다 공유키를 가져야 한다.
* 대칭키를 전달하는 과정에서 키가 유출이 되면 암호의 내용을 복호화할 수 있기 때문에 위험하다.
* 이를 보완하기 위해 나온 방법이 공개키 암호화 방식



#### 공개키 암호화 방식

* 인코딩과 디코딩에 다른 키를 사용하는 알고리즘
* A키로 암호화하면 B키로 복호화할 수 있다. 그 반대 역시 가능
* 인코딩 키 (Public Key)는 공개되어 있으며, 보통 디지털 인증서 안에 포함되어 있다.
* 디코딩 키 (Secret Key)는 호스트만이 개인 디코딩 키를 알고 있다.
* 공개키와 비공개키의 분리는 메시지 인코딩은 누구나 할 수 있도록 해주는 동시에, 메시지의 디코딩을 비밀키 소유자에게만 부여한다.
* 이는 클라이언트가 서버로 안전하게 메시지를 발송하는 것을 쉽게 해준다.
* 단점 : 공개키 암호화 방식의 알고리즘을 계산이 느린 경향이 있다. 



#### 디지털 서명

* 전자 서명을 통해 누가 메시지를 썻고 메시지가 위조되지 않았음을 증명하는데 사용되며, SSL 인증서에서 서비스를 보증하는 방법으로 활용된다. 

* 공개키와 비공개키는 안전한 데이터 전달 이외에도, 데이터 제공자의 신원을 보장 하는데 사용할 수 있다.

* 순서

  1. 비공개키의 소유자가 비공개 키를 이용해서 정보를 암호화

  2. 공개키와 함께 암호화된 정보를 전송

  3. 수신자는 공개키로 암호환된 정보를 복호화

* 암호화된 데이터를 공개키를 가지고 복호화 할 수 있다는 것은 그 데이터가 공개키와 쌍을 이루는 비공개키에 의해서 암호화가 되었다는 것을 의미한다.

* 즉 공개키가 데이터를 제공한 사람의 신원을 보장해주게 되는 것이다.



### CA (Certificate Authority)

* 디지털 인증서를 제공하는 공인된 기업 (Certificate Authority 혹은 Root Certificate)
* 대표적인 CA 서비스 제공 기업
  * Symantec
  * Comodo
  * GoDaddy



