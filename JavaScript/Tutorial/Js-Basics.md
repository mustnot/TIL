# Javascript?

> 자바스크립트는 자바(Java)와 매우 다른 언어로 볼 수 있다.

자바스크립트(javascript)는 '웹 페이지에 생동감을 불어넣기 위해' 만들어진 프로그래밍 언어로 자바스크립트로 작성한 프로그램을 스크립트라고 부른다. 스크립트는 웹페이지의 HTML 안에 작성할 수 있는데, 웹페이지를 불러올 때 스크립트가 자동으로 실행된다. 특별한 준비나 컴파일 없이 보통의 문자 형태로 작성할 수도 있고 실행도 할 수 있다.

자바스크립트는 브라우저뿐만 아니라 서버에서도 실행할 뿐더러 자바스크립트 엔진(Javascript Engine)이라 불리는 특별한 프로그램이 들어 있는 모든 디바이스에서도 동작한다. 브라우저에는 '자바스크립트 가상 머신'이라 불리는 엔진이 내장되어 있는데, 엔진마다 특유의 코드 네임이 있다.

* V8 - Chrome & Opera
* SpiderMonkey - Firefox
* Trident or Trident - IE
* ChakraCore - Microsoft edge
* SquirrelFish - Safari

위 코드네임은 개발 관련 글에서 종종 언급되기 때문에 기억해두자

<br>

### 엔진의 동작 원리

1. 파싱 - 엔진(브라우저라면 내장 엔진)이 스크립트를 읽습니다.
2. 컴파일 - 읽어 들인 스크립트를 기계어로 전환한다.
3. 실행 - 기계어로 전환된 코드가 실행된다.

엔진은 프로세스 각 단계마다 최적화를 진행하여 코드의 진행 방향을 분석한 결과를 토대로 다시 최적화하기도 하는데 이 과정을 거치면서 스크립트의 실행 속도는 점차 빨라진다.

<br>

### 브라우저에서 할 수 있는 일

> 브라우저라는 특성을 이해하는 것이 중요해보인다.

모던 자바스크립트는 "안전한" 프로그래밍 언어로 메모리나 CPU 같은 저수준 영역의 조작을 허용하지 않는다. 애초에 이러한 접근을 필요로 하지 않는 브라우저를 대상으로 만든 언어이기 때문이다.

브라우저에서 자바스크립트로 할 수 있는 일은 다음과 같다.

* 페이지에 새로운 HTML을 추가하거나 기존 HTML 혹은 스타일 수정하기
* 마우스 클릭이나 포인터의 움직임, 키보드 키 눌림 등과 같은 사용자 행동에 반응하기
* 네트워크를 통해 원격 서버에 요청을 보내거나, 파일 다운로드, 업로드하기 (Ajax or Comet 같은 기술 사용)
* 쿠키를 가져오거나 설정하기. 사용자에게 질문을 건네거나 메시지 보여주기
* 클라이언트 측에 데이터 저장하기 (로컬 스토리지)

<br>

### 브라우저에서 할 수 없는 일

브라우저는 보안을 위해 자바스크립트의 기능에 제약을 두었다. (이 부분은 굉장히 중요한 것 같다. 보안적인 요소를 생각하면 보다 쉽게 이해할 수 있을거라고 생각했다 !!) 이런 제약은 악성 웹페이지가 클라이언트 즉 사용자의 개인 정보에 접근하거나 사용자의 데이터를 손상하는 것을 막기 위해 만들어졌다.

제약 사항

* 웹페이지 내 스크립트는 디스크에 저장된 임의의 파일을 읽거나 쓰고 복사하거나 실행할 때 제약을 받을 수 있다. 운영체제가 지원하는 기능을 브라우저가 직접 쓰지 못하게 막혀 있기 때문이다.
    * 모던 브라우저를 사용하면 파일을 다룰 수는 있으나 접근이 제한되어 있다. 사용자가 브라우저 창에 파일을 끌어다 두거나 `<input>` 태그를 통해 파일을 선택할 때와 같은 상황에서만 파일 접근이 허용된다.
* 브라우저 내 탭과 창은 서로의 정보를 알 수 없다. 하지만 자바스크립트를 사용해 한 창에서 다른 창을 열 때는 예외가 적용된다. 하지만 이 경우에도 도메인이나 프로토콜, 포트가 다르다면 페이지에 접근할 수가 없다.
    * 이런 제약사항을 "동일 출처 정책 (Same Origin Policy)"라 부른다. 이 정책을 피하려면 두 페이지는 데이터 교환에 동의해야 하고 동의와 관련된 특수한 자바스크립트 코드를 포함하고 있어야 한다.
* 자바스크립트 이용하면 페이지를 생성한 서버와 쉽게 정보를 주고 받을 수 있다. 하지만 타 사이트나 도메인에서 데이터를 받아오는 것은 불가능하고 가능하더라도 원격 서버에서 명확히 승인을 해줘야 한다. (HTTP Header 등을 이용한 방법)

<br>

### 자바 스크립트만의 강점

* HTML / CSS와 완전히 통합할 수 있음
* 간단한 일은 간단하게 처리할 수 있게 해줌
* 모든 주요 브라우저에서 지원하고 기본 언어로 사용됨

<br>

### 자바스크립트 '너머의' 언어들

> "너머"라길래 전혀 다른 언어를 말하는 줄 알았다.

자바스크립트 문법은 사람마다 각기 다른 기능을 원하기 때문에 모든 사람의 요구 사항을 충족시키지 못했는데, 당연한 이야기지만 프로젝트마다 요구 사항이 천차만별이기 때문이다. 이로 인해 브라우저에서 실행 되기 전 자바스크립트로 트랜스파일(transpile, 변환) 할 수 있는 새로운 언어들이 많이 등장했다.

* CoffeScript : 자바스크립트를 위한 `syntactic sugar` 다. 짧은 문법을 도입하여 명료하고 이해하기 쉬운 코드를 작성할 수 있어 Ruby 개발자들이 선호한다.
* TypeScript : 개발을 단순화하고 복잡한 시스템을 지원하려는 목적으로 "자료형의 명시화 (strict data typing)"에 집중해 만든 언어로 Microsoft에서 개발하였다.
* Flow : TypeScript와 같이 자료형을 강제하나 다른 방식을 사용하고 Facebook이 개발하였다.
* Dart : 모바일 앱과 같이 브라우저가 아닌 환경에서 동작하는 고유의 엔진을 가진 독자적인 언어, Google에서 개발

<br>

<br>

## Hello, World!

진행 중인 튜토리얼은 온라인으로 제공되기 때문에 실행환경을 브라우저로 한정하며 `Node.js`와 같이 브라우저 이외에 환경에 주력하는 학습자를 위해, 브라우저 한정 명령어 (alert 등)는 최소한으로 사용하여 안내한다. 

<br>

### `script` 태그

`<script>` 태그를 이용하면 자바스크립트 프로그램을 HTML 문서 어느 곳에나 삽입할 수 있습니다.

```html
<!DOCTYPE html>
<html lang="en">
<body>
    <p>스크립트 전</p>
    <script>
        alert( 'Hello, world!' );
    </script>
    <p>스크립트 후</p>
</body>
</html>
```

<br>

### 모던 마크업

`<script>` 태그엔 몇 가지 속성(attribute)이 있다. 요즘에는 잘 사용하지 않지만 오래된 코드에서 종종 볼 수 있다.

* type 속성 : `<script type=...>`

    * HTML4 에서는 스크립트에 `type`을 명시하는 것이 필수였다. 따라서 `type="text/javascript"` 속성이 붙은 스크립트를 어렵지 않게 찾을 수 있는데, 이제는 타입 명시가 필수가 아니다. 모던 HTML 표준에선 이 속성의 의미가 바뀌었는데, 이 속성은 자바스크립트 모듈에 사용할 수 있지만 다음에 배운다.

* language 속성 : `<script language=...>`

    * 현재 사용하고 있는 스크립트 언어를 나타내지만, 지금은 자바스크립트가 기본 언어이기 때문에 더는 사용할 필요가 없다.

* 스크립트 전후에 위치한 주석

    * 아주 오래된 책과 가이드에서는 다음과 같이 `<script>` 태그 안에 주석이 존재하는 것을 볼 수 있다.

        ```html
        <script type="text/javascript"><!--
            ...
            //--></script>
        ```

<br>

### 외부 스크립트

자바스크립트 코드의 양이 많은 경우에는 파일로 소분하여 저장할 수 있는데, 이렇게 분해해 놓은 각 파일은 `src` 속성을 사용하여 HTML에 삽입합니다.

```html
<script src="/path/to/script.js>"</script>
```

`src`의 경로는 <u>절대경로</u>를 나타내기도 하고 <u>상대경로</u>를 사용하는 것도 가능하다. 또는 URL 전체를 속성으로 사용할 수도 있습니다.

```html
<script src="https://cdnjs.cloudflare.com/ajax/lib/lodash.js/3.2.0/lodash.js"></script>
```

> 🚨 script에 src 속성이 있으면 태그 내부의 코드는 무시된다.

<br>

### 과제

#### alert 창 띄우기

```html
# alert.html
<!DOCTYPE html>
<html lang="en">
<body>
    <script>
        alert('자바스크립트!');
    </script>
</body>
</html>
```

<br>

#### 외부 스크립트를 이용해 alert 창 띄우기

> 한글이 깨져서 당황했다. encoding 문제인 것 같아 charset을 추가했다.

```javascript
// alert.js
alert('자바스크립트!');
```

```html
<!-- alert.html -->
<!DOCTYPE html>
<html lang="en">
<body>
    <script src="alert.js" charset="utf-8"></script>
</body>
</html>
```

<br>

<br>

## 코드 구조

코드 블록을 만드는 방법을 설명한다. 

<br>

### 문 (statement)

statement는 어떤 작업을 수행하는 문법 구조(syntax structure)와 명령어(command)를 의미합니다. 코드에는 원하는 만큼의 문을 작성할 수 있는데, 이 때 서로 다른 문은 세미콜론(;)으로 구분한다. 그리고 코드의 가독성을 높이기 위해 각 문은 서로 다른 줄에 작성하는 것이 일반적이다.

```script
alert('hello_1');
alert('hello_2');
```

<br>

### 세미콜론 (;)

줄바꿈이 있다면 세미콜론(;)을 생략할 수 있어, 위 코드에서 `;`을 제거하더도 에러 없이 동작한다. 그 이유는 자바스크립트는 암시적으로 줄바꿈을 세미콜론으로 해석하는데, 이런 동작 방식을 "세미콜론 자동 삽입"이라 부른다. 대부분의 경우, 줄바꿈은 세미콜론을 의미하나 "대부분의 경우"이지 "항상"을 의미하진 않는다.

```javascript
alert(3 +
     1
     + 2);
```

이 같은 경우에는 줄바꿈을 세미콜론으로 이해하면 안된다. 반면, 세미콜론이 정말로 필요하지만 자바스크립트가 이를 추정하지 "못하는" 상황도 존재한다.

<br>

### 주석

**1줄 주석**

```javascript
// 이 주석은 한 줄 주석
```

**여러줄 주석**

```javascript
/* 두 줄 이상 주석 예제
이것은 주석입니다.
*/
```

<br>

### 엄격 모드

자바스크립트는 꽤 오랫동안 호환성 이슈 없이 발전해왔으며 기존의 기능을 변경하지 않으면서 새로운 기능들이 추가되었다. 덕분에 기존에 작성한 코드는 절대 망가지지 않는다는 장점이 있었다. 하지만 자바스크립트 창시자들이 했던 실수나 불완전한 결정이 언어 안에 영원히 박제된다는 단점이 있다.

이런 상황은 ECMAScript5(ES5)가 등장하기 전인 2009년까지 지속되었고, 새롭게 제정된 ES5에서는 새로운 기능이 추가되고 기존 기능 중 일부가 변경되었다. 기존 기능을 변경하였기 때문에 하위 호환성 문제는 여지 없이 발생했고 그래서 변경사항 대부분은 ES5의 기본 모드에선 활성화되지 않도록 설계되었다. 대신 `use strict`라는 특별 지시자를 사용해 엄격 모드(strict mode)를 활성화 했을 때만 이 변경사항이 활성화되게 해놓았다.

<br>

#### Use Strict

지시자 `"use strict"` 혹은 `'use stric'`은 단순한 문자열처럼 생겼지만. 이 지시자가 스크립트 최상단에 오면 스크립트 전체가 "모던한" 방식으로 동작된다.

```javascript
"use strict";
```

명령어를 그룹화하는 방식인 함수에 대해선 곧 학습할 예정으로 함수에 대해 학습하기 전 "use strict"는 스크립트 최상단이 아닌 함수 본문 맨 앞에 올 수 있다는 점을 기억하자. 이렇게 하면 오직 해당 함수만 엄격 모드로 실행된다.

> ⚠️ use strict를 취소할 방법은 없다.

<br>

#### 'use strict'를 꼭 사용해야 하는가?

모던 자바스크립트는 '클래스'와 '모듈'이라 불리는 진일보한 구조를 제공하는데, 이 둘을 사용하면 use strict가 자동으로 적요요된다. 따라서 이 둘을 사용하고 있다면 스크립트에 "use strict"를 붙일 필요가 없다. 하지만 사용하지 않는다면, "use strict"를 항상 사용하도록 한다.

<br>

## alert, prompt, confirm 을 이용한 상호작용

브라우저 환경에서 사용되는 최소한의 사용자 인터페이스 기능인 `alert`, `prompt`, `confirm`에 대해 알아본다.

<br>

#### alert

이 함수가 실행되면 사용자가 '확인(OK)' 버튼을 누를 때까지 메세지를 보여주는 창이 계속 떠있게 된다.

<br>

#### prompt

브라우저에서 제공하는 `prompt` 함수는 두 개의 인수를 받는다. 실행되면 텍스트 메시지와 입력 필드(input field), 확인(OK) 및 취소(Cancle) 버튼이 있는 모달 창을 띄워준다.

```javascript
result = prompt(title, [default]);
```

* `title` : 사용자에게 보여줄 문자열
* `default` : 입력 필드의 초기값 (선택값)

> ℹ️ 인수를 감싸는 대괄호 `[...]` 의 의미
>
> 매개변수가 필수가 아닌 선택값이라는 것을 의미한다.

사용자는 프롬프트 대화상자의 입력 필드에 원하는 값을 입력하고 확인을 누를 수 있고, 값을 입력하길 원치 않는 경우 취소나 `Esc` 를 통해 빠져나갈 수 있습니다.

`prompt` 함수는 사용자가 입력 필드에 기재한 문자열을 반환하고 사용자가 입력을 취소한 경우 `null`이 반환된다.

```javascript
let age = prompt('나이를 입력하시오.', 100);
alert(`당신의 나이는 ${age}살 입니다.`); // 당신의 나이는 100살 입니다.
```

<br>

#### confirm

```javascript
result = confirm(question);
```

`confirm` 함수는 매개변수로 받은 `question`과 확인 및 취소 버튼이 있는 모달 창을 보여준다.

사용자가 확인을 누르면 `true`, 그 외에는 `false`를 반환한다.

```javascript
let isAdmin = confirm('Are you Admin?');
alert(isAdmin);
```

<br>

### 과제

#### 간단한 페이지 만들기

사용자에게 이름을 물어보고, 입력받은 이름을 그대로 출력해주는 페이지를 만들어 보세요.

```javascript
// getname.js
"use strict";

let name;
name = prompt('What is your name?', '');
document.write(name);
```

```html
<!DOCTYPE html>
<html lang="en">
<body>
    <script src="getname.js"></script>
</body>
</html>
```

