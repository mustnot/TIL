# 🐳 Docker Introduce

> 📌 **도커**는 **컨테이너**를 사용하여 응용프로그램을 더 쉽게 만들고 배포하고 실행할 수 있도록 설계된 도구로 **컨테이너** 기반의 오픈소스 가상화 플랫폼이자 생태계이다.

<br>

## Docker 기본

### What is a Container?

서버에서 **컨테이너**란 다양한 프로그램, 실행환경을 컨테이너로 추상화하고 동일한 인터페이스를 제공하여 프로그램의 배포 및 관리를 단순하게 해준다. 일반적인 컨테이너가 물건을 손쉽게 운송 해주는 것과 같이 프로그램을 손쉽게 이동, 배포, 관리를 할 수 있도록 해준다. AWS, Azure, Google Cloud 등 어디에서든 실행 가능하다.

<br>

### Docker Image & Container

**컨테이너**는 코드와 모든 종속성을 패키지화하여 응용 프로그램이 한 컴퓨팅 환경에서 다른 컴퓨팅 환경으로 빠르고 안정적으로 실행되도록 하는 소프트웨어의 <u>표준 단위</u>이다.

**컨테이너 이미지**란 코드, 런타임, 시스템 도구, 시스템 라이브러리 및 설정과 같은 응용 프로그램을 실행하는 데 필요한 모든 것을 포함하는 가볍고 독립적이며 실행 가능한 **소프트웨어 패키지** 이다

또한 **컨테이너 이미지**는 런타임에 컨테이너가 되고 도커 컨테이너의 경우 도커 엔진에서 실행될 때 이미지가 컨테이너가 된다. 리눅스와 윈도우 기반 어플리케이션 모두에서 사용할 수 있는 컨테이너화된 소프트웨어는 인프라에 관계 없이 항상 동일하게 실행된다.

컨테이너는 **<u>소프트웨어를 환경으로부터 격리</u>**시키고 개발과 스테이징의 차이에도 불구하고 균일하게 작동하도록 보장한다.

<br>

### Docker를 사용할 때의 흐름

1. Docker CLI에 <u>명령어</u>를 입력

2. Docker 서버 (=Daemon) 에서 <u>명령어</u>를 받아 그것에 따라 이미지 생성 혹은 컨테이너 실행 등 모든 작업을 실행한다.



#### 📌 실행 흐름

1. **도커 CLI**에 명령어 입력
2. **도커 CLI**에서 **도커 서버**에 **이미지**가 있는지 확인
   * 만약 이미지가 있다면, 바로 실행
   * 만약 이미지가 없다면, 이미지가 보관되어 있는 **도커 허브**에서 가져와 도커 서버에 실행한다.

<br>

### 도커와 기존 가상화 기술과의 차이를 통한 컨테이너 이해

**하이퍼 바이저 기반의 가상화**란 호스트 시스템에서 다수의 게스트 OS를 구동하는 소프트웨어로 하드웨어를 가상화하여 하드웨어와 각각의 VM을 모니터링하는 중간 관리자이다. 

* 네이티브 하이퍼 바이저
  * 하이퍼 바이저가 하드웨어를 직접 제어하기에 자원을 효율적으로 사용 가능하며, 별도의 호스트 OS가 없으므로 오버헤드가 적다. 하지만 여러 하드웨어 드라이버를 세팅해야하므로 설치가 어렵다는 단점이 있다.
* 호스트형 하이퍼 바이저
  * 일반적인 소프트웨어처럼 호스트 OS 위에 실행되며, 하드웨어 자원을 VM 내부의 게스트 OS에 에뮬레이트 하는 방식으로 오버헤드가 크다. 하지만 게스트 OS 종류에 대한 제약이 없고 구현이 다소 쉽기 때문에 일반적으로 많이 사용하는 방법이다.



**컨테이너 기반의 가상화**는 하이퍼 바이저 기반의 가상화와 유사한 구조를 갖고 있다. VM과 비교했을 때 컨테이너는 하이퍼바이저와 달리 게스트 OS가 필요하지 않으므로 더 가볍다. 어플리케이션을 실행할 때는 컨테이너 방식에서는 호스트 OS 위에 어플리케이션의 실행 패키지인 이미지를 배포하기만 하면 되지만, 반대로 VM의 경우 VM을 띄우고 자원을 할당한 다음 게스트 OS를 부팅한 후에 실행 해야한다는 차이점이 있다.

**도커 컨테이너**에서 돌아가는 애플리케이션은 컨테이너가 제공하는 격리 기능 내부에 샌드박스가 존재하지만, 여전히 같은 호스트의 다른 컨테이너와 **동일한 커널**을 공유한다. 결과적으로 컨테이너 내부에서 실행되는 프로세스는 호스트 시스템(모든 프로세스를 나열할 수 있는 충분한 권한 존재)에서 볼 수 있다.

> 📌 VM과 달리 도커 컨테이너는 호스트에서 어떤 프로세스가 실행되고 있는지 명령어를 통해 확인이 가능하다.

<br>

#### 그럼 컨테이너는 어떠한 기술로 격리될까?

리눅스에서 쓰이는 Cgroup(control groups)과 네임스페이스(namespaces)에 대해 알아야하는데, 이것들은 컨테이너와 호스트에서 실행되는 다른 프로세스 사이에 벽을 만드는 즉 격리시키는 리눅스 커널 기능들이다.

* C Group
  * CPU, 메모리, Network Bandwith, HD i/o 등 프로세스 그룹의 시스템 리소스 사용량을 관리, 즉 어떤 어플리케이션에 사용량이 너무 많다면 C Group에 넣어 CPU와 메모리를 사용 제한하는 기능
* NameSpace
  * 하나의 시스템에서 프로세스를 격리시킬 수 있는 가상화 기술로 별개의 독립된 공간을 사용하는 것처럼 격리된 환경을 제공하는 경량 프로세스 가상화 기술

<br>

